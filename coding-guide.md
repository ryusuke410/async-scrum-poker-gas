| 項目          | ルール                                                          | 目的/理由              | 具体例（OK/NG）                                                                                       | 備考                                   |           |
| ----------- | ------------------------------------------------------------ | ------------------ | ------------------------------------------------------------------------------------------------ | ------------------------------------ | --------- |
| 変数宣言        | **`const` 基本**／`let` はやむを得ない可変だけ／**`var` 禁止**                | 再代入バグ防止・可読性        | OK: `const rows = ...` ／ NG: `var i = 0`                                                         | ループでも可能な限り `const` を使う               |           |
| 関数宣言        | **アロー関数**を `const` で束縛                                       | `this` 依存排除・一貫性    | OK: `const addTable = (arg) => {...}`                                                            | `function` は原則使わない                   |           |
| `this` の扱い  | **`this` を前提にしない**                                           | 暗黙状態の混入防止          | OK: 引数経由で渡す ／ NG: `this.sheet` 依存                                                                | 必要なら外スコープの `const` 参照                |           |
| エントリーポイント配置 | **末尾に配置**。1作用1関数                                             | 読みやすさ・依存順序の明確化     | OK: 末尾に `const runX = () => safeMain(...);`                                                      | 入口は薄く、本体は上で定義                        |           |
| 公開方法（GAS制約） | **トップレベルの `const` アロー関数**を**直接**定義                           | 実行メニュー/トリガ対象に確実に載る | OK: `const testFoo = () => runTestByName("foo");` ／ **NG**: `const testFoo = testByName("foo");` | 工場関数の**戻り値を代入**は不可（UIが拾わない）          |           |
| 簡易ラッパ       | 入口は**超薄い**（引数→本体呼び出し）                                        | 例外処理・ロギング集約        | OK: `const runX = () => safeMain('runX', () => doX())`                                           | 共通 `safeMain` に集約                    |           |
| ログ          | **`Logger.log`** 統一（`console.*` 禁止）                          | 実行ログの一元化           | OK: `Logger.log(JSON.stringify(obj))`                                                            | `logInfo/logWarn/logError` で薄くラップ    |           |
| strict      | 先頭に **`'use strict';`**                                      | 事故防止               | 先頭1行                                                                                             | V8でも明示                               |           |
| JSDoc 基本    | **`// @ts-check`**、**全引数/戻り値に型**                             | エディタで型検査           | `/** @param {string} id @return {number} */`                                                     | `@typedef` で共通型定義                    |           |
| JSDoc 詳細    | **Closure互換記法**（`string\|number`、`Array<T>`、`Record<K,V>` 等） | 表現力・統一             | `/** @typedef {{id:string, amt:number}} Row */`                                                  | Nullable は \`Type                    | null\` 推奨 |
| 命名          | 関数: lowerCamel／型: **UpperCamel**／定数: **SCREAMING\_SNAKE**    | 可読・役割明確            | `buildForm`, `TableSpec`, `TIMEOUT_MS`                                                           | 関数名は**動詞-名詞**（`appendRows` など）       |           |
| 副作用分離       | I/O と計算を分離                                                   | テスト容易・再利用性         | OK: `calc()` と `applyToSheet()` を分離                                                              | 入口でワークフロー構成                          |           |
| 例外          | **失敗は投げる**／入口で一括捕捉＋ログ                                        | 異常の早期検出            | OK: `throw new Error('…')` → `safeMain` で捕捉                                                      | リトライは明示時のみ                           |           |
| 定数ブロック      | **設定定数は冒頭**に集約                                               | ハードコード散在防止         | OK: `const CONFIG = {...}`                                                                       | シートID等を集中管理                          |           |
| GAS 呼び出し    | **バッチ思考**（get/set まとめる）                                      | パフォ効率・整合性          | OK: `Sheets.Spreadsheets.batchUpdate(...)`                                                       | Advanced Services 前提時                |           |
| 依存          | **1ファイル `code.gs` に集約**                                      | 配布・管理容易            | サブファイルを増やさない                                                                                     | テスト用入口は必要に応じ追加                       |           |
| フォーマット      | 2スペース／セミコロン必須／行長目安 120                                       | 体裁統一               | —                                                                                                | エディタで保存時整形                           |           |
| コメント        | **関数ヘッダは JSDoc**／内部は最小限                                      | 仕様の可視化             | 何を・なぜを書く                                                                                         | どうやるかはコードで示す                         |           |
| 配列処理・ループ    | **`for...of` と `map` を優先**、**`forEach` は回避**                 | 可読性・早期 return・例外制御 | OK: `for (const r of rows) {...}`／`arr.map(...)` ／ NG: `arr.forEach(...)`                        | **テーブル処理では index ループ可**（列位置計算が必要なため） |           |
| if 文        | **常に中括弧 `{}` を付ける**                                          | ヒューマンエラー防止         | OK: `if (cond) { do(); }` ／ NG: `if (cond) do();`                                                | ガード節でも中括弧必須                          |           |
